# Chapter 6. 비지도 학습

## 6-1. 군집 알고리즘 (Clustering Algorithm)

- **비지도 학습 (Unsupervised Learning)**  
  - 정답(레이블, target)이 없는 데이터를 기반으로 학습하는 머신러닝 알고리즘.
  - 주요 목표: 데이터의 구조, 분포, 패턴 등을 파악하여 유사한 데이터끼리 그룹화.

- **코랩 환경 사용 팁**
  - `!`로 시작하는 명령은 리눅스 셸 명령으로 실행됨.
  - `wget`: 원격 서버에서 파일 다운로드
    - 예: `!wget https://example.com/file.csv -O saved_file.csv`
  - `-O`: 다운로드한 파일의 저장 이름 지정 옵션

- **시각화와 통계 처리**
  - `matplotlib.pyplot.subplots()`: 여러 그래프를 행과 열 형태로 배치
    - 예: `fig, axs = plt.subplots(1, 3)` → 가로로 3개의 그래프 생성
  - `np.mean()`:
    - `axis=0`: 열(column) 방향 평균 (세로로 평균)
    - `axis=1`: 행(row) 방향 평균 (가로로 평균)
  - `plt.hist()`: 히스토그램 출력
    - `alpha` 옵션으로 투명도 조절 (예: `alpha=0.5`)
  - `plt.legend()`: 범례 표시
  - `plt.bar()`: 막대그래프 출력
  - `np.argsort()`: 배열의 값을 오름차순으로 정렬한 인덱스를 반환
  - `figsize=(가로, 세로)`: 인치 단위 그래프 크기 설정
  - `plt.axis('off')`: x축, y축 제거하여 이미지 시각적으로 깔끔하게 표시

- **군집 (Clustering)**
  - 데이터 샘플 간의 유사도를 기반으로 유사한 샘플끼리 묶는 작업
  - **클러스터 (Cluster)**: 군집화된 하나의 그룹
  - 주요 목적:
    - 데이터 구조 이해
    - 전처리 단계에서 유사 샘플 군집화
    - 이상치 탐지 등 다양한 분석 목적 활용

---

## 6-2. K-평균 알고리즘 (K-Means Clustering)

- **개요**
  - 데이터를 사전에 정의된 `k`개의 클러스터로 나누는 군집 알고리즘
  - 각 클러스터는 중심점(centroid)을 기준으로 구성됨

- **주요 속성 및 메서드**
  - `KMeans(n_clusters=k)`: 클러스터 개수를 지정하여 모델 생성
  - `fit(data)`: 데이터를 기반으로 클러스터 중심점과 군집 할당 수행
  - `labels_`: 각 샘플이 속한 클러스터 라벨
  - `cluster_centers_`: 최종적으로 수렴한 각 클러스터 중심의 좌표
  - `transform(data)`: 각 샘플과 클러스터 중심 간 거리 행렬 반환
  - `n_iter_`: 알고리즘이 수렴하기까지 반복한 횟수

- **불리언 인덱싱**
  - `km.labels_ == 0` 형태로 특정 클러스터에 속한 데이터 추출 가능
  - 예: `data[km.labels_ == 0]` → 0번 클러스터에 속한 데이터

- **K-평균 알고리즘의 특징**
  - 장점:
    - 구현이 간단하고 계산 속도가 빠름
    - 대용량 데이터에서도 효율적
  - 단점:
    - 클러스터 개수 `k`를 사전에 지정해야 함
    - 초기 중심값 설정에 민감 → 로컬 최적해에 머무를 수 있음
    - 구 형태의 클러스터에 유리 (비구형, 밀도 기반 군집에는 부적합)

- **클러스터 개수 결정 - 엘보우 기법 (Elbow Method)**
  - **이너셔(Inertia)**: 각 클러스터 중심과 그 클러스터에 속한 샘플 간 거리의 제곱합
    - 이너셔 값이 작을수록 군집 품질이 높다고 볼 수 있음
  - `k`값을 증가시키며 이너셔의 감소 곡선을 관찰
  - 그래프의 꺾이는 지점이 적절한 `k`값 (팔꿈치처럼 꺾이는 모양)

