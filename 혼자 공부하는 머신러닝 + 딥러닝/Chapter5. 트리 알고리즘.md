# Chapter 5. νΈλ¦¬ μ•κ³ λ¦¬μ¦

## 5-1. κ²°μ • νΈλ¦¬ (Decision Tree)

### 1) λ΅μ§€μ¤ν‹± νκ·€λ΅ μ™€μΈ λ¶„λ¥

- `DataFrame.info()`: λ°μ΄ν„°ν”„λ μ„μ ν–‰, μ—΄, κ²°μΈ΅μΉ μ—¬λ¶€ λ“± λ©”νƒ€ μ •λ³΄ ν™•μΈ
- `DataFrame.describe()`: κΈ°μ΄ ν†µκ³„ μ”μ•½ μ •λ³΄ μ κ³µ
- μ£Όμ” ν†µκ³„ μ§€ν‘:
  - **mean**: ν‰κ· 
  - **std**: ν‘μ¤€νΈμ°¨
  - **min / max**: μµμ† / μµλ€κ°’
  - **25% / 50% / 75%**: 1μ‚¬λ¶„μ„μ, μ¤‘κ°„κ°’(2μ‚¬λ¶„μ„μ), 3μ‚¬λ¶„μ„μ

### 2) κ²°μ • νΈλ¦¬λ€?

- **μ¤λ¬΄κ³ κ° κ²μ„**μ²λΌ μ§λ¬Έμ„ λμ Έκ°€λ©° μ •λ‹µμ„ μΆν€κ°€λ” λ°©μ‹
- λ°μ΄ν„°λ¥Ό μ λ‚λ μ μλ” μ§λ¬Έμ„ μ°Ύμ•„ **λ¶„λ¥ μ •ν™•λ„**λ¥Ό λ†’μ΄λ” κ²ƒμ΄ λ©ν‘
- μ‚¬μ΄ν‚·λ° ν΄λμ¤: `DecisionTreeClassifier`

#### π“ κ²°μ • νΈλ¦¬ κµ¬μ΅° μ©μ–΄

| μ©μ–΄         | μ„¤λ… |
|------------|------|
| λ£¨νΈ λ…Έλ“    | νΈλ¦¬μ λ§¨ μ„ λ…Έλ“, μ²μ λ¶„ν• λλ” κΈ°μ¤€μ΄ λλ” λ…Έλ“ |
| λ‚΄λ¶€ λ…Έλ“    | μ¤‘κ°„μ— μ„μΉν•μ—¬ λ¶„κΈ°λ¥Ό λ§λ“λ” λ…Έλ“ |
| λ¦¬ν”„ λ…Έλ“    | λ” μ΄μƒ λ¶„ν• λμ§€ μ•λ” μµμΆ… λ…Έλ“, μμΈ΅ κ²°κ³Όλ¥Ό λ‚νƒ€λƒ„ |

- μ‹κ°ν™” μ‹ `figsize()`λ¥Ό ν†µν•΄ κ·Έλ¦Ό ν¬κΈ°(λ‹¨μ„: μΈμΉ)λ¥Ό μ΅°μ •
- λ¦¬ν”„ λ…Έλ“λ¥Ό μ ν• μ—†μ΄ λλ¦¬λ©΄ **κ³Όλ€μ ν•©(Overfitting)** λ°μƒ
- λ”°λΌμ„ **μ–Έμ κΉμ§€ μ΄λ¶„ν™”λ¥Ό ν• μ§€**μ— λ€ν• μ΅°κ±΄ ν•„μ” β†’ **κ°€μ§€μΉκΈ°(pruning)**λ΅ μ μ–΄

#### β… λ…Έλ“ μ„¤λ… μ”μ†

- **test condition**: λ…Έλ“κ°€ μƒν”μ„ λ¶„λ¦¬ν•λ” κΈ°μ¤€
- **samples**: ν„μ¬ λ…Έλ“μ— μ†ν• μƒν” μ
- **value**: κ° ν΄λμ¤λ³„ μƒν” μ (μ: [μ–‘μ„±, μμ„±])
- μ΅°κ±΄ λ§μ΅± μ‹ μ™Όμ½ μμ‹ λ…Έλ“, κ·Έλ ‡μ§€ μ•μΌλ©΄ μ¤λ¥Έμ½ μμ‹ λ…Έλ“λ΅ μ΄λ™

#### π μ‹κ°μ  νΉμ§•

- ν΄λμ¤ λΉ„μ¨μ΄ λλ ·ν• μλ΅ μƒ‰μ΄ μ§„ν•κ² ν‘μ‹λ¨
- λ¦¬ν”„ λ…Έλ“μ—μ„λ” **κ°€μ¥ λ§μ€ ν΄λμ¤**κ°€ μμΈ΅ ν΄λμ¤κ°€ λ¨

#### π” λ¶μλ„ κ°λ…

- **μ§€λ‹ λ¶μλ„(Gini Impurity)**:
  
  $$
  \text{Gini} = 1 - \sum_{k=1}^{K} (p_k)^2
  $$

  μ: μ΄μ§„ λ¶„λ¥μΌ κ²½μ°,  
  $$
  \text{Gini} = 1 - (\text{μ–‘μ„± λΉ„μ¨}^2 + \text{μμ„± λΉ„μ¨}^2)
  $$

- **μ •λ³΄ μ΄λ“(Information Gain)**:  
  λ¶€λ¨ λ…Έλ“μ™€ μμ‹ λ…Έλ“ κ°„μ λ¶μλ„ μ°¨μ΄.  
  κ²°μ • νΈλ¦¬λ” **μ •λ³΄ μ΄λ“μ΄ μµλ€ν™”**λλ„λ΅ λ¶„ν• 

- μ‚¬μ΄ν‚·λ°μ—μ„ `criterion='gini'` (κΈ°λ³Έ) λλ” `'entropy'`λ΅ λ³€κ²½ κ°€λ¥

#### β‚οΈ κ°€μ§€μΉκΈ° λ°©λ²•

- `max_depth`, `min_samples_split`, `min_impurity_decrease` λ“±μ λ§¤κ°λ³€μλ΅ νΈλ¦¬ μ„±μ¥ μ ν• κ°€λ¥
- **κ²°μ • νΈλ¦¬λ” νΉμ„± κ°„μ μ¤μΌ€μΌ μ°¨μ΄λ¥Ό μ‹ κ²½ μ“°μ§€ μ•μ**  
  β†’ **ν‘μ¤€ν™” μ „μ²λ¦¬ λ¶ν•„μ”**, μ¤νλ ¤ λ°©ν•΄λ  μ μμ

### 3) ν•µμ‹¬ ν‚¤μ›λ“ μ”μ•½

- **κ²°μ • νΈλ¦¬**: μ/μ•„λ‹μ¤ κΈ°λ° μ§λ¬ΈμΌλ΅ λ¶„λ¥, μ„¤λ…λ ¥μ΄ λ›°μ–΄λ‚ λ¨λΈ
- **λ¶μλ„**: λ…Έλ“ λ‚΄ λ°μ΄ν„°μ νΌν•© μ •λ„λ¥Ό μμΉν™”ν• κΈ°μ¤€ (μ§€λ‹, μ—”νΈλ΅ν”Ό)
- **μ •λ³΄ μ΄λ“**: λ¶„ν• λ΅ μΈν•΄ κ°μ†ν• λ¶μλ„μ ν¬κΈ°
- **κ°€μ§€μΉκΈ°**: κ³Όλ€μ ν•© λ°©μ§€λ¥Ό μ„ν• νΈλ¦¬ μ„±μ¥ μ ν•
- **νΉμ„± μ¤‘μ”λ„**: κ° νΉμ„±μ΄ μ „μ²΄ λ¶„λ¥ μ •ν™•λ„ ν–¥μƒμ— κΈ°μ—¬ν• μ •λ„

---

## 5-2. κµμ°¨ κ²€μ¦κ³Ό κ·Έλ¦¬λ“ μ„μΉ

### 1) κ²€μ¦ μ„ΈνΈ(Validation Set)

- ν…μ¤νΈ μ„ΈνΈλ” μ¤μ§ **μµμΆ… μ„±λ¥ ν‰κ°€μ©**μΌλ΅ μ‚¬μ©
- ν›λ ¨ μ¤‘κ°„μ— ν…μ¤νΈ μ„ΈνΈλ¥Ό μμ£Ό ν™•μΈν•λ©΄ **ν…μ¤νΈ μ„ΈνΈμ— κ³Όμ ν•©λ  μ„ν—**
- ν•΄κ²°μ±…: ν›λ ¨ μ„ΈνΈμ—μ„ μΌλ¶€λ¥Ό **κ²€μ¦ μ„ΈνΈ**λ΅ λ¶„λ¦¬ν•μ—¬ ν•μ΄νΌνλΌλ―Έν„° νλ‹ λ° μ„±λ¥ ν‰κ°€

### 2) κµμ°¨ κ²€μ¦ (Cross Validation)

- ν›λ ¨ λ°μ΄ν„° μΌλ¶€λ¥Ό κ²€μ¦μ©μΌλ΅ μ‚¬μ©ν•λ©΄ ν›λ ¨ λ°μ΄ν„° μ–‘μ΄ μ¤„μ–΄λ“λ” λ‹¨μ 
- **κµμ°¨ κ²€μ¦**μ€ ν›λ ¨ μ„ΈνΈλ¥Ό μ—¬λ¬ μ΅°κ°μΌλ΅ λ‚λ„κ³ , λ§¤λ² λ‹¤λ¥Έ μ΅°κ°μ„ κ²€μ¦ μ„ΈνΈλ΅ μ‚¬μ©ν•μ—¬ λ°λ³µ ν‰κ°€
- **k-ν΄λ“ κµμ°¨ κ²€μ¦**:
  - λ°μ΄ν„°λ¥Ό kλ“±λ¶„ν•μ—¬ kλ² λ°λ³µ
  - κ° λ°λ³µλ§λ‹¤ λ‹¤λ¥Έ ν΄λ“κ°€ κ²€μ¦ μ„ΈνΈ μ—­ν• 
  - κ²°κ³Ό ν‰κ· μ„ μ‚¬μ©ν•μ—¬ μ•μ •λ ν‰κ°€ μν–‰

| ν΄λ“ μ | μ‚¬μ© μμ‹ |
|--------|---------|
| 5      | μΌλ°μ μΈ κΈ°λ³Έ μ„¤μ • |
| 10     | λ” μ•μ •μ μΈ μ„±λ¥ ν‰κ°€ κ°€λ¥ |

- μ‚¬μ΄ν‚·λ° ν•¨μ: `cross_validate()`

#### π”§ μ£Όμμ‚¬ν•­

- `cross_validate()`λ” λ°μ΄ν„°λ¥Ό **μλ™μΌλ΅ μ„μ§€ μ•μ**
- λ¶„ν• κΈ°(splitter) λ…μ‹ ν•„μ”:
  - **νκ·€**: `KFold`
  - **λ¶„λ¥**: `StratifiedKFold` (ν΄λμ¤ λΉ„μ¨ μ μ§€)

---

### 3) ν•μ΄νΌ νλΌλ―Έν„° νλ‹

#### π“ μ©μ–΄ μ •λ¦¬

| κµ¬λ¶„             | μ„¤λ… |
|----------------|------|
| λ¨λΈ νλΌλ―Έν„°      | ν•™μµ κ³Όμ •μ—μ„ μλ™μΌλ΅ μ΅°μ •λ¨ (ex. νΈλ¦¬μ κ°€μ¤‘μΉ) |
| ν•μ΄νΌ νλΌλ―Έν„°    | μ‚¬μ©μκ°€ μ§μ ‘ μ§€μ •ν•΄μ•Ό ν•¨ (ex. max_depth) |

- λ‹¤μ–‘ν• ν•μ΄νΌνλΌλ―Έν„° μ΅°ν•©μ„ μ‹¤ν—ν•κ³  ν‰κ°€ β†’ μ„±λ¥ ν–¥μƒ λ„λ¨

#### π” κ·Έλ¦¬λ“ μ„μΉ (Grid Search)

- μ‚¬μ΄ν‚·λ° ν΄λμ¤: `GridSearchCV`
- **κµμ°¨ κ²€μ¦ + νλΌλ―Έν„° μ΅°ν•© νƒμƒ‰**μ„ ν• λ²μ— μν–‰
- `cv=5`κ°€ κΈ°λ³Έ β†’ κ° μ΅°ν•©λ§λ‹¤ 5λ² ν‰κ°€

μ: `min_impurity_decrease` κ°’ 5κ° Γ— 5-ν΄λ“ = **25κ° λ¨λΈ ν›λ ¨**

- λ³‘λ ¬ μ²λ¦¬: `n_jobs=-1` β†’ λ¨λ“  CPU μ½”μ–΄ μ‚¬μ©
- κ²°κ³Ό ν™μ©:
  - `best_estimator_`: μµκ³  μ„±λ¥ λ¨λΈ
  - `best_params_`: μµμ  ν•μ΄νΌνλΌλ―Έν„° μ΅°ν•©
  - `best_score_`: μµκ³  κ²€μ¦ μ μ

- `argmax()` λ“±μΌλ΅ κ°€μ¥ λ†’μ€ μ„±λ¥μ μΈλ±μ¤ μ°ΎκΈ° κ°€λ¥

---

### 3-2) λλ¤ μ„μΉ (Random Search)

- ν•μ΄νΌνλΌλ―Έν„°μ λ²”μ„κ°€ λ„“κ±°λ‚ μ„Έλ°€ν• μ΅°μ •μ΄ μ–΄λ ¤μΈ κ²½μ° μ‚¬μ©
- μ§€μ •ν• **ν™•λ¥  λ¶„ν¬μ—μ„ λ¬΄μ‘μ„ μƒν”λ§**ν•μ—¬ νλΌλ―Έν„° μ„¤μ •

#### π“ λ¶„ν¬ ν•¨μ μμ‹

- `randint(a, b)`:  
  β†’ `[a, b)` λ²”μ„μ **μ •μ**μ—μ„ λ¬΄μ‘μ„ μ¶”μ¶ (μ΄μ‚°ν• λ¶„ν¬)

- `uniform(a, b)`:
  β†’ `[a, a + b]` λ²”μ„μ **μ‹¤μ(float)**μ—μ„ λ¬΄μ‘μ„ μ¶”μ¶ (μ—°μ†ν• λ¶„ν¬)

- μ¥μ :  
  β†’ λ§μ€ μ΅°ν•©μ„ μ‹λ„ν•μ§€ μ•κ³ λ„ μ„±λ¥μ΄ μΆ‹μ€ ν•μ΄νΌνλΌλ―Έν„° μ΅°ν•©μ„ λΉ λ¥΄κ² μ°Ύμ„ μ μμ

---

## β… μ”μ•½

- **κ²°μ • νΈλ¦¬**λ” μ§κ΄€μ μ΄κ³  ν•΄μ„ κ°€λ¥ν•μ§€λ§ κ°€μ§€μΉκΈ°λ¥Ό ν•μ§€ μ•μΌλ©΄ κ³Όλ€μ ν•©λκΈ° μ‰¬μ›€
- **λ¶μλ„(μ§€λ‹, μ—”νΈλ΅ν”Ό)**λ” λ…Έλ“ λ¶„ν•  κΈ°μ¤€μ΄λ©°, μ •λ³΄ μ΄λ“μ€ μ„±λ¥ ν–¥μƒ μΈ΅μ • λ„κµ¬
- **κµμ°¨ κ²€μ¦**μ€ λ¨λΈμ μΌλ°ν™” μ„±λ¥μ„ μ•μ •μ μΌλ΅ ν‰κ°€
- **κ·Έλ¦¬λ“ μ„μΉ**λ” κ°€λ¥ν• λ¨λ“  ν•μ΄νΌνλΌλ―Έν„° μ΅°ν•©μ„ ν‰κ°€ν•μ—¬ μµμ  μ΅°ν•©μ„ νƒμƒ‰
- **λλ¤ μ„μΉ**λ” μ΅°ν•© μκ°€ λ§μ„ λ• ν¨μ¨μ μΈ νƒμƒ‰ λ°©λ²•

